(function(t){function e(e){for(var o,r,a=e[0],l=e[1],c=e[2],d=0,f=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&f.push(s[r][0]),s[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(f.length)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,a=1;a<n.length;a++){var l=n[a];0!==s[l]&&(o=!1)}o&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var o={},s={app:0},i=[];function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"0817":function(t,e,n){"use strict";n("0bf5")},"0bf5":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("fb6a");var o=n("3f08"),s=n("a026"),i=n("5f5b"),r=n("2f62"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("h1",[t._v(" Test nested set ")]),t._l(this.$store.state.alert,(function(e,o){return[n("b-alert",{key:o,attrs:{variant:"danger",dismissible:""},model:{value:e.showDismissibleAlert,callback:function(n){t.$set(e,"showDismissibleAlert",n)},expression:"alert.showDismissibleAlert"}},[t._v(" Dismissible Alert! ")])]})),n("b-card",{attrs:{"no-body":""}},[n("b-tabs",{attrs:{pills:"",card:"",vertical:""}},[n("b-tab",{attrs:{title:"Tab 1",active:""}},[n("b-card-text",[n("div",{staticClass:"row m-2 d-flex"},[n("b-button",{on:{click:t.add_struct}},[t._v("add struct")])],1),n("nested",{attrs:{elems:this.$store.state.elements}})],1)],1),n("b-tab",{attrs:{title:"Tab 2"}},[n("b-card-text",[t._v("Tab contents 2")])],1),n("b-tab",{attrs:{title:"Tab 3"}},[n("b-card-text",[t._v("Tab contents 3")])],1)],1)],1)],2)},l=[],c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-12"},[n("draggable",t._b({attrs:{list:t.elems,move:t.onMoveCallback},on:{start:t.move,end:t.move}},"draggable",t.dragOptions,!1),t._l(t.elems,(function(e){return n("div",{key:e.pk,staticClass:"container-fluid border m-2"},[n("row",{attrs:{row:e}}),e.tree_children?n("NestedItem",{attrs:{elems:e.tree_children}}):t._e(),e.children?n("NestedItem",{attrs:{elems:e.children}}):t._e()],1)})),0)],1)},u=[],d=n("b76a"),f=n.n(d),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return"user"==t.row.type_obj?n("fragment",[t.edit?n("div",{staticClass:"row p-2 "},[n("b-input-group",{attrs:{tag:"form"}},[n("b-form-input",{model:{value:t.oldRow.fields.fullname,callback:function(e){t.$set(t.oldRow.fields,"fullname",e)},expression:"oldRow.fields.fullname"}}),n("b-form-input",{model:{value:t.oldRow.fields.email,callback:function(e){t.$set(t.oldRow.fields,"email",e)},expression:"oldRow.fields.email"}}),n("b-form-input",{model:{value:t.oldRow.fields.phone,callback:function(e){t.$set(t.oldRow.fields,"phone",e)},expression:"oldRow.fields.phone"}}),n("b-form-input",{attrs:{list:t.oldRow.pk.split(":").join("_")},model:{value:t.oldRow.fields.work,callback:function(e){t.$set(t.oldRow.fields,"work",e)},expression:"oldRow.fields.work"}}),n("b-form-datalist",{attrs:{id:t.oldRow.pk.split(":").join("_"),options:t.selected}}),n("b-input-group-append",[n("b-button",{on:{click:function(e){return t.save()}}},[t._v("Save")]),n("b-button",{on:{click:function(e){return t.cansel()}}},[t._v("Cansel")])],1)],1)],1):n("div",{staticClass:"row p-2"},[n("b-col",[t._v(t._s(t.row.fields.fullname))]),n("b-col",[t._v(t._s(t.row.fields.email))]),n("b-col",[t._v(t._s(t.row.fields.phone))]),n("b-col",[t._v(t._s(t.row.fields.work))]),n("b-col",{staticStyle:{"flex-grow":"inherit"}},[n("b-button-group",{attrs:{size:"sm"}},[n("b-button",{attrs:{variant:"warning"},on:{click:function(e){return t.editRow()}}},[t._v("Edit")]),n("b-button",{attrs:{variant:"info"},on:{click:function(e){return t.deleteRow()}}},[t._v("Delete")])],1)],1)],1)]):n("fragment",[t.edit?n("div",{staticClass:"row p-2 "},[n("b-input-group",{attrs:{tag:"form"}},[n("b-form-input",{attrs:{placeholder:t.row.fields.fullname},model:{value:t.oldRow.fields.name,callback:function(e){t.$set(t.oldRow.fields,"name",e)},expression:"oldRow.fields.name"}}),n("b-button",{on:{click:function(e){return t.save()}}},[t._v("Save")]),n("b-button",{on:{click:function(e){return t.cansel()}}},[t._v("Cansel")])],1)],1):n("div",{staticClass:"row p-2"},[n("b-col",[t._v(t._s(t.row.fields.name))]),n("b-col",{staticStyle:{"flex-grow":"inherit"}},[n("b-button-group",{attrs:{size:"sm"}},[n("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.new_user()}}},[t._v("Add user")]),n("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.new_struct()}}},[t._v("Add struct")]),n("b-button",{attrs:{variant:"warning"},on:{click:function(e){return t.editRow()}}},[t._v("Edit")]),n("b-button",{attrs:{variant:"info"},on:{click:function(e){return t.deleteRow()}}},[t._v("Delete")])],1)],1)],1)])},b=[],m={data:function(){return{oldRow:{},edit:!1}},computed:{selected:{get:function(){return this.$store.state.select}}},props:{row:{required:!1,type:Object}},methods:{save:function(){this.$store.dispatch("changeNode",this.oldRow),this.edit=!this.edit,this.$store.state.isEdit=!1},new_user:function(){this.$store.dispatch("createNode",{type:"u",username:this.row.pk,email:"",phone:"",parent:this.row.pk})},new_struct:function(){this.$store.dispatch("createNode",{type:"s",name:this.row.pk,parent:this.row.pk})},cansel:function(){this.edit=!this.edit,this.$store.state.isEdit=!1},editRow:function(){Object.assign(this.oldRow,this.row),this.$store.state.isEdit=!0,this.edit=!this.edit},deleteRow:function(){this.$store.dispatch("deleteTree",{dalete:!0,target:this.row.pk})}}},h=m,v=n("2877"),w=Object(v["a"])(h,p,b,!1,null,null,null),g=w.exports,_=void 0,k={name:"NestedItem",order:16,components:{draggable:f.a,row:g},computed:{dragOptions:function(){return{animation:0,group:"description",disabled:!1,ghostClass:"ghost"}},reversedMessage:function(){return this.$store.state.isEdit=!this.$store.state.isEdit,1},edit:{get:function(){return this.$store.state.isEdit},set:function(t){this.$store.state.isEdit=t}},myList:{get:function(){return this.elems},set:function(t){this.elems=t}}},props:{elems:{required:!0,type:Array}},methods:{onMoveCallback:function(t){return this.target=t.draggedContext.element,this.tomove=t.relatedContext.element,!0},save_data:function(t){this.$store.state.isEdit=!this.$store.state.isEdit,console.log(t)},test_data:function(t){return console.log(t,_)},move:function(){if(this.$store.state.isEdit=!this.$store.state.isEdit,void 0!==this.target&&void 0!==this.tomove){var t=this.target.pk,e=this.tomove.pk;this.$store.dispatch("moveTree",{target:t,tomove:e})}}},data:function(){return{target:null,tomove:null}}},y=k,E=(n("0817"),Object(v["a"])(y,c,u,!1,null,"7942f80e",null)),R=E.exports,$={name:"App",delimiters:["[[","]]"],components:{nested:R},methods:{add_struct:function(){this.$store.dispatch("createNode",{type:"s",name:"root"})}}},x=$,T=(n("034f"),Object(v["a"])(x,a,l,!1,null,null,null)),A=T.exports,O=(n("f9e3"),n("2dd8"),n("bc3a").default);s["default"].prototype.axios=O,s["default"].use(o["a"].Plugin),s["default"].use(i["a"]),s["default"].config.productionTip=!1,s["default"].use(r["a"]);var j=new r["a"].Store({state:{elements:[],alert:[],isEdit:!1,select:[]},mutations:{UPDATE:function(t,e){while(t.elements.length>0)t.elements.pop();t.elements=e.slice(0)},ALERT:function(t){t.alert.push({showDismissibleAlert:!0})},SELECT_UPDATE:function(t,e){while(t.select.length>0)t.select.pop();t.select=e.slice(0)}},actions:{longPulling:function(t){t.state.isEdit||(O.get("/api/v1/tree").then((function(e){t.commit("UPDATE",e.data)})),O.get("/api/v1/select").then((function(e){t.commit("SELECT_UPDATE",e.data)})))},moveTree:function(t,e){O.post("/api/v1/tree",e).then((function(e){"301"!==e.data&&t.commit("ALERT")}))},deleteTree:function(t,e){O.post("/api/v1/tree",e).then((function(e){"301"!==e.data&&t.commit("ALERT")}))},createNode:function(t,e){O.put("/api/v1/tree",e).then((function(e){"201"!==e.data&&t.commit("ALERT")}))},changeNode:function(t,e){O.patch("/api/v1/tree",e).then((function(e){"201"!==e.data&&t.commit("ALERT")}))}}});new s["default"]({store:j,render:function(t){return t(A)},mounted:function(){var t=this;setInterval((function(){t.$store.dispatch("longPulling")}),1e3)}}).$mount("#app")},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.7fe8ce41.js.map